<!DOCTYPE html>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=windows-1252" />
    <title>Programming error organization block (OB 121) (S7-300, S7-400)</title>
    <link rel="stylesheet" type="text/css" href="../Resources/css/sipsplus_wb_xhtml.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="../Resources/css/sipsplus_wb_screen.css" />
    <link rel="stylesheet" type="text/css" media="print" href="../Resources/css/sipsplus_wb_print.css" />
    <script src="../Resources/scripts/hhlp_sipsplus_wb.js" type="text/javascript">
        <!--scripting xhtml-->
    </script>
</head>
<body id="bodyID">
<div id="nsbanner">
    <div id="menu">
        <table class="menubar" cellspacing="0">
            <tr id="menubar">
                <td>
                    <span class="menuActive" id="menuSamples">Examples</span> <span class="menuActive" id="menuSeeAlso">See also</span> <span class="menuActive" id="menuHistory">History</span> <span class="menuActive" id="menuExtra">Extra</span> </td>
            </tr>
        </table>
    </div>
    <div id="menuSectionItems" style="display:none">
        <a href="#" onclick="window.location.href='#block_1'">Description         </a>
        <a href="#" onclick="window.location.href='#block_2'">Function of the programming error OB</a>
        <a href="#" onclick="window.location.href='#block_3'">Local data for the programming error OB</a>
        <a href="#" onclick="window.location.href='#block_4'">Programming OB 121</a>
        <!--dynamic section items-->
    </div>
    <div id="menuSeeAlsoItems" style="display:none">
        <!--dynamic see-also-items-->
    </div>
    <div id="menuSamplesItems" style="display:none">
        <!--dynamic sample items-->
    </div>
    <div id="menuHistoryItems" style="display:none">
        <script type="text/javascript">
            <!--
            printHistory("");
            function printHistory(headline) {
                var browsehistory = new Array();
                if(window.name != "")	browsehistory = window.name.split("\n\n");

                for(var i=0;i<browsehistory.length-1;i++) {
                    if(i==0) {
                        if(headline != "") document.writeln(headline);
                    }
                    document.writeln("<a href=\"" + browsehistory[i].split(";;")[1] + "\">" + browsehistory[i].split(";;")[0] + "</a>");
                }

            }
            -->
        </script>
    </div>
    <div id="menuExtraItems" style="display:none">
        <a href="#" onclick="window.location.href='mk:@MSITStore:PEGlossaryenUS.chm::/10793805451/10794886027.htm'">Glossary</a>
        <!--dynamic items for pdf, glossary and expanding glossary entries-->
    </div>
    <div id="titlerowdefault">
        <table class="title" style="width:100%">
            <tr>
                <td class="title" style="vertical-align:middle">Programming error organization block (OB 121)</td>
                <td class="title" style="width:30; text-align:right; vertical-align:top">
                    <div>
                        <img class="title" style="width:30; height:30; border-style:none" alt="S7-300, S7-400" src="../Resources/images/tooltip-icon-variant.gif" /> </div>
                </td>
                <td class="title" style="width:30; text-align:right; vertical-align:top">
                    <img class="title" style="width:30; height:30; border-style:none" alt="" src="../Resources/images/facts.png" /> </td>
            </tr>
        </table>
    </div>
</div>
<div id="nstext" style="vertical-align:bottom">
    <a id="block_1"></a><p class="BlocktitleFirst">Description         </p><p>The CPU operating system calls OB 121 whenever an event occurs that is caused by an error related to the processing of the program. For example, if your program calls a block that has not been loaded on the CPU, OB 121 is called.</p><a id="block_2"></a><p class="Blocktitle">Function of the programming error OB</p><p>OB 121 is executed in the same priority class as the interrupted block. </p><p>If OB 121 is not programmed, the CPU changes the operating mode from RUN to STOP.</p><p>S7 provides the following instructions for use in masking and unmasking start events of OB 121 during the execution of your program:</p><ul><li><p>The "<a href="#" onclick="window.location.href='mk:@MSITStore:ProgExtInstr34enUS.chm::/15891218571/16762688523.htm'">MSK_FLT</a>" instruction masks certain error codes.</p></li><li><p>The "<a href="#" onclick="window.location.href='mk:@MSITStore:ProgExtInstr34enUS.chm::/15891218571/16762703883.htm'">DMSK_FLT</a>" instruction unmasks the error codes that were masked by the "<a href="#" onclick="window.location.href='mk:@MSITStore:ProgExtInstr34enUS.chm::/15891218571/16762688523.htm'">MSK_FLT</a>" instruction.</p></li><li><p>The "<a href="#" onclick="window.location.href='mk:@MSITStore:ProgExtInstr34enUS.chm::/15891218571/16762706443.htm'">READ_ERR</a>" instruction reads the event status register.</p></li></ul><a id="block_3"></a><p class="Blocktitle">Local data for the programming error OB</p><p>The following table lists the temporary (TEMP) tags of the programming error OB. The default names of OB 121 have been selected as the tag names.</p><a id="table_0"></a> <p class="p_table_title"></p><div><table class="table_default" width="100%" cellspacing="0" cellpadding="0"><colgroup><col width="26.5%" /><col width="20.4%" /><col width="53.0%" /></colgroup><tr class="first"><th><p class="p_table_lb">Tag</p></th><th><p class="p_table_lb">Data type</p></th><th><p class="p_table_lb">Description</p></th></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_EV_CLASS</p></td><td><p class="p_table_l" style="margin-top: 4px; ">BYTE</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Event class and identifiers: B#16#25</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_SW_FLT</p></td><td><p class="p_table_l" style="margin-top: 4px; ">BYTE</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Error code (possible values: B#16#21, B#16#22, B#16#23, B#16#24, B#16#25, B#16#26, B#16#27, B#16#28, B#16#29, B#16#30, B#16#31, B#16#32, B#16#33, B#16#34, B#16#35, B#16#3A, B#16#3C, B#16#3D, B#16#3E, B#16#3F)</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_PRIORITY</p></td><td><p class="p_table_l" style="margin-top: 4px; ">BYTE</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Priority class of the OB where the error occurred</p><p style="margin-top: 4px; ">For S7-1500 CPUs: priority, default value: 7</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_OB_NUMBR</p></td><td><p class="p_table_l" style="margin-top: 4px; ">BYTE</p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB number (121)</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_BLK_TYPE</p></td><td><p class="p_table_l" style="margin-top: 4px; ">BYTE</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Type of block where the error occurred (no valid value is entered here in case of S7-300): B#16#88: OB, B#16#8A: DB, B#16#8C: FC, B#16#8E: FB</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_RESERVED_1</p></td><td><p class="p_table_l" style="margin-top: 4px; ">BYTE</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Reserved</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">WORD</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Source of the error (depends on error code); for example:</p><ul class="table"><li><p>Register in which the conversion error occurred</p></li><li><p>Incorrect address (read/write error)</p></li><li><p>Incorrect timer/counter/block number</p></li><li><p>Incorrect memory area</p></li></ul></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_BLK_NUM</p></td><td><p class="p_table_l" style="margin-top: 4px; ">WORD</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Number of the block with the MC7 command that caused the error (no valid number is entered here for an S7-300)</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_PRG_ADDR</p></td><td><p class="p_table_l" style="margin-top: 4px; ">WORD</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Relative address of the MC7 instruction that has caused the error</p><p class="p_table_l" style="margin-top: 4px; ">FB) (no valid number is entered here for an S7-300)</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">OB121_DATE_TIME</p></td><td><p class="p_table_l" style="margin-top: 4px; ">DATE_AND_TIME </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Date and time when the OB was called</p></td></tr></table></div><p> </p><p>The error code-dependent tags have the following meaning:</p><a id="table_1"></a> <p class="p_table_title"></p><div><table class="table_default" width="100%" cellspacing="0" cellpadding="0"><colgroup><col width="15.2%" /><col width="22.2%" /><col width="62.5%" /></colgroup><tr class="first"><th><p class="p_table_lb">Error code</p></th><th><p class="p_table_lb">Tag</p></th><th><p class="p_table_lb">Meaning</p></th></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#21</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">BCD conversion error</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Identifier for the affected tab (W#16#0000: battery 1)</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#22</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Area length error when reading</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_RESERVED_1</p></td><td><ul class="table"><li><p>Bit 7 to 4 type of access:</p><ul><li><p>0: Bit access,</p></li><li><p>1: Byte access,</p></li><li><p>2: Word access,</p></li><li><p>3: DWord access</p></li></ul></li><li><p>Bit 3 to 0 memory area:</p><ul><li><p>0: I/O area</p></li><li><p>1: Process image input</p></li><li><p>2: Process image output</p></li><li><p>3: Bit memory</p></li><li><p>4: Global DB</p></li><li><p>5: Instance DB</p></li><li><p>6: own local data</p></li><li><p>7: Local data of the caller</p></li></ul></li></ul></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#23</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Area length error when writing</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_RESERVED_1</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Same as for error code B#16#22</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#28</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Read access to a byte, word or double word with a pointer, the bit address of which is not 0</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_RESERVED_1</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Same as for error code B#16#22</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#29</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Write access to a byte, word or double word with a pointer, the bit address of which is not 0</p><p class="p_table_l" style="margin-top: 4px; ">Faulty byte address. Refer to OB121_RESERVED_1 for the data area and the type of access</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_RESERVED_1</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Same as for error code B#16#22</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#24</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Area error when reading</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">The low byte contains the identifier for the unauthorized area (B#16#86 own local data area)</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#25</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Area error when writing</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">The low byte contains the identifier for the unauthorized area (B#16#86 own local data area)</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#26</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Error in timer number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Unauthorized number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#27</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Error in counter number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Unauthorized number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#30</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Write access to a write-protected global DB</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Unauthorized DB number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#31</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Write access to a write-protected instance DB</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Unauthorized DB number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#32</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">DB number error when accessing a global DB</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Unauthorized DB number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#33</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">DB number error when accessing an instance DB</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">Unauthorized DB number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#34</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Number error during FC call</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">FC number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#35</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">FB number error during FC call</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">FB number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#3A</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Access to a DB that is not loaded; the DB number is located in the permitted area</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">DB number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#3C</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Access to an FC that is not loaded; the FC number lies in the permissible area</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">FC number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#3D</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Access to an instruction that is not available; the SFC number is located in the permitted area</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">SFC number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#3E</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Access to an FB that is not loaded; the FB number lies in the permissible area</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">FB number</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; ">B#16#3F</p></td><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">Access to an SFB that is not available; the SFB number lies in the permissible area</p></td></tr><tr><td><p class="p_table_l" style="margin-top: 4px; "> </p></td><td><p class="p_table_l" style="margin-top: 4px; ">OB121_FLT_REG</p></td><td><p class="p_table_l" style="margin-top: 4px; ">SFB number</p></td></tr></table></div><p> </p><a id="block_4"></a><p class="Blocktitle">Programming OB 121</p><p>You must add OB 121 to the blocks of your CPU. Write the program that is to be executed in OB 121 to the generated block, and load the block to the CPU as part of your user program.</p><p>You can use OB 121, for example, as follows:</p><ul><li><p>You evaluate the start information in OB 121.</p></li><li><p>You enter the cause of the error in an alarm data block.</p></li></ul><p> </p></div>
</body>
</html>